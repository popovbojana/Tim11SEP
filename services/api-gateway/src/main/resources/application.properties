spring.application.name=api-gateway
server.port=8080

server.ssl.enabled=true
server.ssl.key-store=classpath:sep-keystore.p12
server.ssl.key-store-type=PKCS12
server.ssl.key-store-password=${SSL_PASSWORD}
server.ssl.key-password=${SSL_PASSWORD}
server.ssl.key-alias=sep-alias

eureka.client.service-url.defaultZone=https://localhost:8761/eureka/
eureka.instance.prefer-ip-address=true
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true

eureka.instance.non-secure-port-enabled=false
eureka.instance.secure-port-enabled=true
eureka.instance.secure-port=${server.port}

eureka.client.tls.enabled=true
eureka.client.tls.key-store=classpath:sep-keystore.p12
eureka.client.tls.key-store-type=PKCS12
eureka.client.tls.key-store-password=${SSL_PASSWORD}
eureka.client.tls.key-password=${SSL_PASSWORD}
eureka.client.tls.trust-store=classpath:sep-keystore.p12
eureka.client.tls.trust-store-password=${SSL_PASSWORD}

spring.cloud.gateway.server.webflux.discovery.locator.enabled=true
spring.cloud.gateway.server.webflux.discovery.locator.lower-case-service-id=true

spring.cloud.gateway.server.webflux.httpclient.ssl.use-insecure-trust-manager=true

spring.cloud.gateway.server.webflux.globalcors.add-to-simple-url-handler-mapping=true
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowedorigins=https://localhost:4200,https://localhost:4300,https://localhost:4400
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowedmethods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowedheaders=Authorization,Content-Type,X-Merchant-Key,X-Merchant-Password
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].exposedheaders=Authorization
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowcredentials=true

spring.cloud.gateway.server.webflux.default-filters=SecureHeaders

spring.cloud.gateway.server.webflux.filter.secure-headers.x-frame-options=DENY
spring.cloud.gateway.server.webflux.filter.secure-headers.strict-transport-security=max-age=63072000; includeSubDomains; preload

spring.cloud.gateway.server.webflux.filter.secure-headers.content-security-policy=default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;

management.endpoints.web.exposure.include=health,info,gateway
management.endpoint.gateway.access=read-only

bucket4j.enabled=true

bucket4j.filters.0.cache-name=buckets
bucket4j.filters.0.url=/api/auth/login
bucket4j.filters.0.strategy=first
bucket4j.filters.0.rate-limits.0.bandwidths.0.capacity=5
bucket4j.filters.0.rate-limits.0.bandwidths.0.time=1
bucket4j.filters.0.rate-limits.0.bandwidths.0.unit=minutes

bucket4j.filters.1.cache-name=buckets
bucket4j.filters.1.url=/api/payments/init
bucket4j.filters.1.strategy=first
bucket4j.filters.1.rate-limits.0.bandwidths.0.capacity=10
bucket4j.filters.1.rate-limits.0.bandwidths.0.time=1
bucket4j.filters.1.rate-limits.0.bandwidths.0.unit=minutes