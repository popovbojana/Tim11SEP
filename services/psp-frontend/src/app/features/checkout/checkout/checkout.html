<div class="checkout-page">
  <div class="checkout-card">
    @if (error()) {
      <div class="error-box">
        <b class="error-icon">⚠️</b>
        {{ error() }}
      </div>
    }

    @if (!payment()) {
      <div class="skeleton-loader">
        <div class="shimmer amount"></div>
        <div class="shimmer btn"></div>
      </div>
    } @else {
      <div class="amount-section">
        <span class="label">Payment for Order #{{ payment()?.merchantOrderId }}</span>
        <span class="amount">
          {{ payment()?.amount | number:'1.2-2' }}
          <span class="currency">{{ payment()?.currency }}</span>
        </span>
      </div>

      <div class="payment-methods">
        <p class="methods-title">Available Payment Methods</p>
        
        @if (!methods()) {
          <p class="loading-small">Fetching options...</p>
        } @else {
          <div class="btn-grid">
            @for (method of methods(); track method) {
              <button 
                type="button" 
                class="method-btn"
                [disabled]="processingMethod() !== null"
                (click)="onPay(method)">
                
                @if (processingMethod() === method) {
                  <span class="spinner"></span>
                  Connecting...
                } @else {
                  Pay with {{ method }}
                }
              </button>
            }

            @if (methods()?.length === 0) {
              <div class="error-box">
                No active payment methods found for this merchant.
              </div>
            }
          </div>
        }
      </div>
    }
    
    <div class="footer-info">
      <p>Secure payment processed by PSP System</p>
    </div>
  </div>
</div>