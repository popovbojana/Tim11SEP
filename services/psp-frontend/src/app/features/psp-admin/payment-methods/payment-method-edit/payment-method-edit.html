<section class="authPage">
  <div class="authCard">
    <header class="authHeader">
      <h4 class="authTitle">Edit Payment Method</h4>
      <p class="authSubtitle">
        Update plugin details. Ensure service name matches Eureka.
      </p>
    </header>

    @if (fetching()) {
      <div class="state">
        <span class="loader"></span>
        Loading method details...
      </div>
    } @else {
      @if (errorMessage()) {
        <div class="alert">
          {{ errorMessage() }}
        </div>
      }

      <form [formGroup]="form" (ngSubmit)="submit()" class="authForm">
        <div class="field">
          <label class="label" for="name">Display Name</label>
          <input
            id="name"
            class="input"
            type="text"
            formControlName="name"
            [class.inputError]="form.controls.name.touched && form.controls.name.invalid"
          />
          @if (form.controls.name.touched && form.controls.name.invalid) {
            <p class="errorText">Please enter a valid name.</p>
          }
        </div>

        <div class="field">
          <label class="label" for="serviceName">Eureka Service Name</label>
          <input
            id="serviceName"
            class="input"
            type="text"
            formControlName="serviceName"
            [class.inputError]="form.controls.serviceName.touched && form.controls.serviceName.invalid"
          />
          @if (form.controls.serviceName.touched && form.controls.serviceName.invalid) {
            <p class="errorText">Service name is required.</p>
          }
        </div>

        <button 
          class="btnPrimary" 
          type="submit" 
          [disabled]="loading() || form.invalid || isUnchanged()"
        >
          {{ loading() ? 'Saving Changes...' : 'Save Changes' }}
        </button>

        <p class="hint">
          <a class="link" routerLink="/payment-methods">Cancel</a>
        </p>
      </form>
    }
  </div>
</section>