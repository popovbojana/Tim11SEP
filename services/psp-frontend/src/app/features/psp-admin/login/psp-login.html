<section class="authPage">
  <div class="authCard">
    <header class="authHeader">
      <p class="authSubtitle">
        {{ showMfa() ? 'Check your email for the verification code.' : 'Sign in to manage merchants and payment methods.' }}
      </p>
    </header>

    @if (error()) {
      <div class="alert">
        {{ error() }}
      </div>
    }

    @if (!showMfa()) {
      <form [formGroup]="loginForm" (ngSubmit)="submitLogin()" class="authForm">
        <div class="field">
          <label class="label" for="email">Email address</label>
          <input id="email" class="input" type="email" formControlName="email" />
        </div>

        <div class="field">
          <label class="label" for="password">Password</label>
          <input id="password" class="input" type="password" formControlName="password" />
        </div>

        <button class="btnPrimary" type="submit" [disabled]="loading()">
          {{ loading() ? 'Signing in...' : 'Login' }}
        </button>
      </form>
    } @else {
      <div class="mfaContainer">
        <div class="otpInputs">
          @for (step of otpSteps; track step) {
            <input 
              type="text" 
              class="otpInput" 
              maxlength="1" 
              (input)="onOtpInput($event, step)"
              (keydown)="onKeyDown($event, step)"
              placeholder="-"
            />
          }
        </div>

        <button class="btnPrimary" (click)="submitMfa()" [disabled]="loading()">
          {{ loading() ? 'Verifying...' : 'Verify Code' }}
        </button>
        
        <button type="button" class="btnSecondary" (click)="showMfa.set(false)">Back to Login</button>
      </div>
    }
  </div>
</section>